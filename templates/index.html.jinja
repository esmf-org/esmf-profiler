<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>ESMF Profile: {{name}}</title>

        <!-- Bootstrap core CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

        <link rel="stylesheet" href="https://cdn.webix.com/edge/webix.css" type="text/css">
        <script src="https://cdn.webix.com/edge/webix.min.js" type="text/javascript"></script>


	<!-- Favicons -->
	<!---
	    <link rel="apple-touch-icon" href="/docs/4.4/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
	    <link rel="icon" href="/docs/4.4/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
	    <link rel="icon" href="/docs/4.4/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
	    <link rel="manifest" href="/docs/4.4/assets/img/favicons/manifest.json">
	    <link rel="mask-icon" href="/docs/4.4/assets/img/favicons/safari-pinned-tab.svg" color="#563d7c">
	    <link rel="icon" href="/docs/4.4/assets/img/favicons/favicon.ico">
	    <meta name="msapplication-config" content="/docs/4.4/assets/img/favicons/browserconfig.xml">
	-->
	    
	<meta name="theme-color" content="#563d7c">


	<style>
	  .bd-placeholder-img {
              font-size: 1.125rem;
              text-anchor: middle;
              -webkit-user-select: none;
              -moz-user-select: none;
              -ms-user-select: none;
              user-select: none;
	  }
	  
	  @media (min-width: 768px) {
              .bd-placeholder-img-lg {
		  font-size: 3.5rem;
              }
	  }
	</style>

	<!-- Custom styles for this template -->
	<link href="https://getbootstrap.com/docs/4.4/examples/dashboard/dashboard.css" rel="stylesheet">
    </head>

    <body>
      <nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
        <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">ESMF Profile: {{name}}  (Generated: {{now}})</a>

	<!--
	    <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">
	    <ul class="navbar-nav px-3">
	      <li class="nav-item text-nowrap">
		<a class="nav-link" href="#">Sign out</a>
	      </li>
	    </ul>
        -->
      </nav>

<div class="container-fluid">
  <div class="row">
    <nav class="col-md-2 d-none d-md-block bg-light sidebar">
      <div class="sidebar-sticky">

        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
          <span>Application Info</span>
          <!--
           <a class="d-flex align-items-center text-muted" href="#" aria-label="Add a new report">
            <span data-feather="plus-circle"></span>
          </a>
          -->
        </h6>
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="package"></span>
              Component Configuration
            </a>
          </li>
        </ul>

        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
          <span>Timing</span>
        </h6>
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link active" href="#">
              <span data-feather="clock"></span>
              Timing Summary <span class="sr-only">(current)</span>
            </a>

          </li>

          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="bar-chart-2"></span>
              Load Balance
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="share-2"></span>
              MPI Profile
            </a>
          </li>
        </ul>

        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
          <span>Memory</span>
        </h6>
        <ul class="nav flex-column>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="activity"></span>
              Memory Profile
            </a>
          </li>
        </ul>

        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
          <span>I/O</span>
        </h6>
        <ul class="nav flex-column>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="hard-drive"></span>
              NetCDF Profile
            </a>
          </li>
        </ul>

      </div>
    </nav>

    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Timing Summary</h1>
        <!--
        <div class="btn-toolbar mb-2 mb-md-0">
          <div class="btn-group mr-2">
            <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
            <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
          </div>
          <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
            <span data-feather="calendar"></span>
            This week
          </button>
        </div>
        -->

      </div>
{#
{%- macro print_row(rs, prefix) %}
      {%- for region_name, child in rs.children.items() %}
      {% if region_name != "ROOT" %}
      <tr>
          <td>{{prefix ~ region_name}}</td>
	  <td>{{child.pet_count}}</td>
	  <td>{{child.count_each}}</td>
	  <td>{{ ((child.total_sum / child.pet_count) / (1000*1000*1000)) | round(4) }}</td>
	  <td>{{ (child.total_min / (1000*1000*1000)) | round(4) }}</td>
	  <td>{{child.total_min_pet}}</td>
	  <td>{{ (child.total_max / (1000*1000*1000)) | round(4) }}</td>
	  <td>{{child.total_max_pet}}</td>
      </tr>
      {%- endif %}
      {{ print_row(child, prefix ~ "&nbsp;&nbsp;&nbsp;") }}      
      {%- endfor %}
{%- endmacro %}

      
      <!-- temporary output for testing -->
      <table>
	<th>
	  <tr>
	    <td>Region</td>
	    <td>PETs</td>
	    <td>Count</td>
	    <td>Mean (s)</td>
	    <td>Min (s)</td>
	    <td>Min PET</td>
	    <td>Max (s)</td>
	    <td>Max PET</td>
	  </tr>
	 </th>
      {{ print_row(region_summary, "") }}
      </table>
#}

      <div id="summary_timing_table"></div>

<!--	
      <canvas class="my-4 w-100" id="myChart" width="900" height="380"></canvas>
-->

      <!--
      <div class="table-responsive">
        <table class="table table-striped table-sm">
          <thead>
            <tr>
              <th>#</th>
              <th>Header</th>
              <th>Header</th>
              <th>Header</th>
              <th>Header</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1,001</td>
              <td>Lorem</td>
              <td>ipsum</td>
              <td>dolor</td>
              <td>sit</td>
            </tr>
          </tbody>
        </table>
      </div>
      -->

    </main>
  </div>
</div>

        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.9.0/feather.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
        <script src="https://getbootstrap.com/docs/4.4/examples/dashboard/dashboard.js"></script>

{%- macro print_json(rs) %}
      {%- for region_name, child in rs.children.items() %}
      {
         "id": "{{region_name}}",
         "region": "{{region_name}}",
         "pets": "{{child.pet_count}}",
         "count": "{{ child.count_each if child.counts_match else "MULTIPLE"}}",
         "mean": "{{ "{0:0.5f}".format(child.total_mean_s) }}",
         "min": "{{ "{0:0.5f}".format(child.total_min_s) }}",
         "minpet":"{{child.total_min_pet}}",
         "max": "{{ "{0:0.5f}".format(child.total_max_s) }}",
         "maxpet":"{{child.total_max_pet}}",
         "open": "true"
         {%- if child.children|length > 0 %}
         , "data": [
         {{ print_json(child) }}
         ]
         {%- endif %}
      }
      {%- if not loop.last %}
      ,
      {%- endif %}
      {%- endfor %}
{%- endmacro %}


	<script>

	  var data = [
	  {{ print_json(region_summary.children["Unknown"]) }}
	  ];

	  webix.ui({
	      id: "timingsum",
	      view: "treetable",
	      container: "summary_timing_table",
	      select: "row",
	      clipboard: "selection",
	      columns:[
		  { id:"region",	header:"Region",	width:250, template:"{common.treetable()} #region#"},
		  { id:"pets",	    header:"PETs"},
		  { id:"count",	    header:"Count"},
		  { id:"mean",      header:"Mean (s)", sort:"int"},
		  { id:"min",	    header:"Min (s)", sort:"int"},
		  { id:"minpet",    header:"Min PET"},
		  { id:"max",	    header:"Max (s)", sort:"int"},
		  { id:"maxpet",    header:"Max PET"}
	      ],
	      autoheight: true,
	      autowidth: true,
	      //on:{
		  //onAfterSelect:function(selection, preserve){
		      //var text = $$("timingsum").getSelectedId(true).join();
		  //    webix.message("Selected: "+selection)
		  //}
	      //},
          data:data
	  });
	</script>





    </body>
</html>
